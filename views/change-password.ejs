<%- include('./partials/header.ejs', {title: `Change Password`}) %> <%-
include('./partials/topMenu.ejs') %> <%- include('./partials/navbar.ejs') %>
<style>
  .password-strength {
    height: 6px;
    border-radius: 3px;
    transition: all 0.3s ease;
  }

  .password-strength.weak {
    width: 25%;
    background-color: #ef4444;
  }
  .password-strength.fair {
    width: 50%;
    background-color: #f59e0b;
  }
  .password-strength.good {
    width: 75%;
    background-color: #3b82f6;
  }
  .password-strength.strong {
    width: 100%;
    background-color: #10b981;
  }

  .input-icon {
    position: absolute;
    right: 16px;
    top: 50%;
    transform: translateY(-50%);
    cursor: pointer;
    color: #6b7280;
  }

  .input-icon:hover {
    color: #374151;
  }

  .password-requirements li {
    transition: all 0.3s ease;
  }

  .password-requirements li.valid {
    color: #10b981;
    font-weight: 500;
  }

  .password-requirements li.valid:before {
    content: "âœ“ ";
    font-weight: bold;
  }

  .flash-message {
    animation: slideDown 0.5s ease forwards;
  }

  @keyframes slideDown {
    from {
      opacity: 0;
      transform: translateY(-20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .gradient-text {
    background: linear-gradient(to right, #63b3ed, #3182ce);
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
  }

  .btn-gradient {
    background: linear-gradient(to right, #63b3ed, #3182ce);
    transition: all 0.3s ease;
  }

  .btn-gradient:hover {
    background: linear-gradient(to right, #3182ce, #2c5282);
    transform: translateY(-2px);
    box-shadow: 0 10px 25px -5px rgba(49, 130, 206, 0.3);
  }

  .btn-gradient:active {
    transform: translateY(0);
  }

  .card-hover {
    transition: all 0.3s ease;
  }

  .card-hover:hover {
    box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
    transform: translateY(-2px);
  }
</style>

<!-- Main Content -->
<div class="p-6 sm:ml-64 mt-16 bg-gray-50/50 min-h-screen">
  <!-- Header Section -->
  <div class="mb-8">
    <div
      class="flex flex-col md:flex-row md:items-center justify-between gap-4"
    >
      <div>
        <h1 class="text-3xl font-bold text-gray-900 mb-2">Security Settings</h1>
        <p class="text-gray-600">
          Update your password to keep your account secure
        </p>
      </div>
      <div class="flex items-center space-x-3">
        <div class="hidden md:block text-right">
          <p class="text-sm text-gray-500">Account Status</p>
          <p class="text-lg font-bold text-green-600">Active</p>
        </div>
        <div
          class="w-12 h-12 rounded-xl bg-gradient-to-br from-[#63b3ed] to-[#3182ce] flex items-center justify-center text-white font-bold"
        >
          J
        </div>
      </div>
    </div>
  </div>

  <!-- Main Content Grid -->
  <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
    <!-- Password Change Form -->
    <div class="lg:col-span-2">
      <div
        class="bg-white rounded-2xl shadow-sm border border-blue-100 p-6 card-hover"
      >
        <!-- Flash Message Area -->
        <div id="flash-message" class="hidden mb-6 p-4 rounded-lg"></div>

        <form id="change-password-form">
          <div class="space-y-6">
            <!-- Current Password -->
            <div>
              <label
                for="currentPassword"
                class="block mb-3 text-sm font-medium text-gray-700"
              >
                <div class="flex items-center">
                  <i class="fas fa-lock mr-2 text-blue-500"></i>
                  Current Password
                </div>
              </label>
              <div class="relative">
                <input
                  type="password"
                  id="currentPassword"
                  name="currentPassword"
                  class="w-full p-4 bg-gray-50 border border-blue-100 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 transition-all duration-300 pr-12"
                  placeholder="Enter your current password"
                  required
                />
                <div class="input-icon" id="toggle-current-password">
                  <i class="fas fa-eye"></i>
                </div>
              </div>
            </div>

            <!-- New Password -->
            <div>
              <label
                for="newPassword"
                class="block mb-3 text-sm font-medium text-gray-700"
              >
                <div class="flex items-center">
                  <i class="fas fa-key mr-2 text-blue-500"></i>
                  New Password
                </div>
              </label>
              <div class="relative">
                <input
                  type="password"
                  id="newPassword"
                  name="newPassword"
                  class="w-full p-4 bg-gray-50 border border-blue-100 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 transition-all duration-300 pr-12"
                  placeholder="Create a new password"
                  required
                />
                <div class="input-icon" id="toggle-new-password">
                  <i class="fas fa-eye"></i>
                </div>
              </div>

              <!-- Password Strength Meter -->
              <div class="mt-4">
                <div class="flex justify-between mb-2">
                  <span class="text-sm font-medium text-gray-700"
                    >Password Strength</span
                  >
                  <span id="strength-text" class="text-sm font-medium"
                    >None</span
                  >
                </div>
                <div class="w-full bg-gray-200 rounded-full h-2">
                  <div id="password-strength" class="password-strength"></div>
                </div>
              </div>

              <!-- Password Requirements -->
              <div
                class="mt-6 p-4 bg-blue-50 rounded-xl border border-blue-100"
              >
                <p class="text-sm font-medium text-gray-700 mb-3">
                  Password Requirements:
                </p>
                <ul
                  class="password-requirements text-sm text-gray-600 space-y-2"
                >
                  <li id="req-length" class="transition-colors">
                    At least 8 characters
                  </li>
                  <li id="req-uppercase" class="transition-colors">
                    One uppercase letter
                  </li>
                  <li id="req-lowercase" class="transition-colors">
                    One lowercase letter
                  </li>
                  <li id="req-number" class="transition-colors">One number</li>
                  <li id="req-special" class="transition-colors">
                    One special character
                  </li>
                </ul>
              </div>
            </div>

            <!-- Confirm Password -->
            <div>
              <label
                for="confirmPassword"
                class="block mb-3 text-sm font-medium text-gray-700"
              >
                <div class="flex items-center">
                  <i class="fas fa-check-circle mr-2 text-blue-500"></i>
                  Confirm New Password
                </div>
              </label>
              <div class="relative">
                <input
                  type="password"
                  id="confirmPassword"
                  name="confirmPassword"
                  class="w-full p-4 bg-gray-50 border border-blue-100 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 transition-all duration-300 pr-12"
                  placeholder="Confirm your new password"
                  required
                />
                <div class="input-icon" id="toggle-confirm-password">
                  <i class="fas fa-eye"></i>
                </div>
              </div>
              <div id="password-match" class="mt-2 text-sm hidden">
                <i class="fas fa-check-circle mr-2 text-green-500"></i>
                <span class="text-green-600 font-medium">Passwords match</span>
              </div>
              <div id="password-mismatch" class="mt-2 text-sm hidden">
                <i class="fas fa-times-circle mr-2 text-red-500"></i>
                <span class="text-red-600 font-medium"
                  >Passwords do not match</span
                >
              </div>
            </div>

            <!-- Submit Button -->
            <div class="pt-4">
              <button
                type="submit"
                id="submit-btn"
                class="btn-gradient text-white font-semibold rounded-xl text-sm w-full px-5 py-4 text-center shadow-sm"
              >
                <span id="btn-text">Update Password</span>
                <span id="btn-loading" class="hidden">
                  <i class="fas fa-spinner fa-spin mr-2"></i> Updating...
                </span>
              </button>
            </div>
          </div>
        </form>
      </div>
    </div>

    <!-- Security Info Sidebar -->
    <div class="space-y-6">
      <!-- Security Guidelines Card -->
      <div
        class="bg-white rounded-2xl shadow-sm border border-blue-100 p-6 card-hover"
      >
        <div class="flex items-center mb-4">
          <div
            class="w-12 h-12 rounded-xl bg-gradient-to-br from-blue-100 to-blue-50 flex items-center justify-center mr-4"
          >
            <i class="fas fa-shield-alt text-blue-600 text-xl"></i>
          </div>
          <div>
            <h3 class="text-lg font-bold text-gray-900">Security Guidelines</h3>
            <p class="text-sm text-gray-600">Keep your account safe</p>
          </div>
        </div>
        <ul class="space-y-3">
          <li class="flex items-start">
            <i class="fas fa-check text-green-500 mr-3 mt-1"></i>
            <span class="text-sm text-gray-700"
              >Never share your password with anyone</span
            >
          </li>
          <li class="flex items-start">
            <i class="fas fa-check text-green-500 mr-3 mt-1"></i>
            <span class="text-sm text-gray-700"
              >Use a combination of letters, numbers, and symbols</span
            >
          </li>
          <li class="flex items-start">
            <i class="fas fa-check text-green-500 mr-3 mt-1"></i>
            <span class="text-sm text-gray-700"
              >Avoid using personal information in your password</span
            >
          </li>
          <li class="flex items-start">
            <i class="fas fa-check text-green-500 mr-3 mt-1"></i>
            <span class="text-sm text-gray-700"
              >Change your password regularly</span
            >
          </li>
        </ul>
      </div>

      <!-- Password History Card -->
      <div
        class="bg-white rounded-2xl shadow-sm border border-blue-100 p-6 card-hover"
      >
        <h3 class="text-lg font-bold text-gray-900 mb-4">Password History</h3>
        <div class="space-y-4">
          <div
            class="flex items-center justify-between pb-4 border-b border-gray-100"
          >
            <div>
              <p class="font-medium text-gray-900">Last Changed</p>
              <p class="text-sm text-gray-600">April 15, 2023</p>
            </div>
            <div
              class="w-10 h-10 rounded-xl bg-green-100 flex items-center justify-center"
            >
              <i class="fas fa-check text-green-600"></i>
            </div>
          </div>
          <div class="flex items-center justify-between">
            <div>
              <p class="font-medium text-gray-900">Password Age</p>
              <p class="text-sm text-gray-600">45 days</p>
            </div>
            <div
              class="w-10 h-10 rounded-xl bg-yellow-100 flex items-center justify-center"
            >
              <i class="fas fa-clock text-yellow-600"></i>
            </div>
          </div>
        </div>
        <div class="mt-6 pt-4 border-t border-gray-100">
          <div class="text-sm text-gray-600">
            <i class="fas fa-info-circle text-blue-500 mr-2"></i>
            It's recommended to change your password every 90 days
          </div>
        </div>
      </div>

      <!-- Quick Actions Card -->
      <div
        class="bg-white rounded-2xl shadow-sm border border-blue-100 p-6 card-hover"
      >
        <h3 class="text-lg font-bold text-gray-900 mb-4">Quick Actions</h3>
        <div class="space-y-3">
          <a
            href="/dashboard"
            class="flex items-center p-3 rounded-lg hover:bg-blue-50 transition-colors duration-300"
          >
            <div
              class="w-10 h-10 rounded-lg bg-blue-100 flex items-center justify-center mr-3"
            >
              <i class="fas fa-home text-blue-600"></i>
            </div>
            <div>
              <p class="font-medium text-gray-900">Back to Dashboard</p>
              <p class="text-sm text-gray-600">Return to main dashboard</p>
            </div>
            <i class="fas fa-chevron-right ml-auto text-gray-400"></i>
          </a>
          <a
            href="/teacher/profile/<%= user._id %>"
            class="flex items-center p-3 rounded-lg hover:bg-blue-50 transition-colors duration-300"
          >
            <div
              class="w-10 h-10 rounded-lg bg-purple-100 flex items-center justify-center mr-3"
            >
              <i class="fas fa-user text-purple-600"></i>
            </div>
            <div>
              <p class="font-medium text-gray-900">Profile Settings</p>
              <p class="text-sm text-gray-600">Update your profile</p>
            </div>
            <i class="fas fa-chevron-right ml-auto text-gray-400"></i>
          </a>
        </div>
      </div>
    </div>
  </div>
</div>

<%- include('./partials/bottonNavBar.ejs') %>
<script src="/js/changePassword.js"></script>
<%- include('./partials/footer.ejs') %>
